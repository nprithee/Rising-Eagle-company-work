---
title: "Product Cost Change"
author: "Rising Eagle Construction LLC"
date: "June 2023"
output:
  html_document:
    code_folding: hide
    number_sections: true
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
library(ezids)
knitr::opts_chunk$set(echo = TRUE)
```

#### Product Percentage change from 2020 to 2021



```{r include=FALSE}
library(readr)
library(ggplot2)

df <- read_csv('/Users/nusratprithee/Documents/Rising-Eagle-company-work/Purchase-History-with-Average-Unit-Price-2020-vs.-2021.csv')



```


### Product type

```{r echo = FALSE}
# Get unique values from the "Type" column
unique_types <- unique(df$Type)

# Print each unique type
for (type in unique_types) {
  print(paste("Product Type:", as.character(type)))
}

```

## Plot of percentage change of price

```{r echo = FALSE}


# Convert the average unit price columns from strings to numeric values
df$`Average Unit Price 01/01/21 to 12/31/21` <- as.numeric(gsub("[$,]", "", df$`Average Unit Price 01/01/21 to 12/31/21`))
df$`Average Unit Price 01/01/20 to 12/31/20` <- as.numeric(gsub("[$,]", "", df$`Average Unit Price 01/01/20 to 12/31/20`))

# Calculate the percentage change
df$`Percentage Change` <- ((df$`Average Unit Price 01/01/21 to 12/31/21` - df$`Average Unit Price 01/01/20 to 12/31/20`) / df$`Average Unit Price 01/01/20 to 12/31/20`) * 100

# Create a bar chart
ggplot(df, aes(x = `Item #`, y = `Percentage Change`)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(x = "Item #", y = "Percentage Change", title = "Percentage Change of Average Unit Price (2020 to 2021)") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_text(aes(label = sprintf("%.1f%%", `Percentage Change`)), vjust = -0.5, size = 3) +
  coord_cartesian(clip = "off") +
  theme(plot.margin = margin(1, 1, 1, 1, "cm"))

```

#  Product Buy Comparison of 2020 to 2021



```{r echo = FALSE}
library(ggplot2)

# Group the data by Item # and Description and sum the quantity buy for 2020-2021
gpca_table <- aggregate(cbind(`Qty Sold 01/01/21 to 12/31/21`, `Qty Sold 01/01/20 to 12/31/20`) ~ `Item #` + `Description`, data = df, sum)

# Create a line plot of quantity buy
ggplot(gpca_table, aes(x = `Item #`, group = 1)) +
  geom_line(aes(y = `Qty Sold 01/01/21 to 12/31/21`, color = "Qty Sold 2021"), size = 1) +
  geom_point(aes(y = `Qty Sold 01/01/21 to 12/31/21`, color = "Qty Sold 2021"), size = 2) +
  geom_line(aes(y = `Qty Sold 01/01/20 to 12/31/20`, color = "Qty Sold 2020"), size = 1) +
  geom_point(aes(y = `Qty Sold 01/01/20 to 12/31/20`, color = "Qty Sold 2020"), size = 2) +
  geom_line(aes(y = `Qty Sold 01/01/21 to 12/31/21`, linetype = "White Year"), color = "black", size = 1, linetype = "dashed") +
  labs(x = "Item #", y = "Quantity Buy", title = "Quantity Buy Comparison") +
  scale_color_manual(values = c("blue", "red"), labels = c("Qty Sold 2021", "Qty Sold 2020")) +
  scale_shape_manual(values = c(16, 16)) +
  scale_linetype_manual(values = "dashed", labels = "White Year") +
  guides(color = guide_legend(override.aes = list(size = 2))) +
 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))





```


#### Product Percentage change from 2021 to 2022


```{r include=FALSE}
library(readr)
library(ggplot2)

df <- read_csv('/Users/nusratprithee/Documents/Rising-Eagle-company-work/Purchase History with Average Unit Price - 2021 vs. 2022.csv')

```

### Product type

```{r echo = FALSE}
# Get unique values from the "Type" column
unique_types <- unique(df$Type)

# Print each unique type
for (type in unique_types) {
  print(paste("Product Type:", as.character(type)))
}

```

## Plot of percentage change of price
```{r echo = FALSE}


# Convert the average unit price columns from strings to numeric values
df$`Average Unit Price 01/01/22 to 12/31/22` <- as.numeric(gsub("[$,]", "", df$`Average Unit Price 01/01/22 to 12/31/22`))
df$`Average Unit Price 01/01/21 to 12/31/21` <- as.numeric(gsub("[$,]", "", df$`Average Unit Price 01/01/21 to 12/31/21`))

# Calculate the percentage change
df$`Percentage Change` <- ((df$`Average Unit Price 01/01/22 to 12/31/22` - df$`Average Unit Price 01/01/21 to 12/31/21`) / df$`Average Unit Price 01/01/21 to 12/31/21`) * 100

# Create a bar chart
ggplot(df, aes(x = `Item #`, y = `Percentage Change`)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(x = "Item #", y = "Percentage Change", title = "Percentage Change of Average Unit Price (2021 to 2022)") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_text(aes(label = sprintf("%.1f%%", `Percentage Change`)), vjust = -0.5, size = 3) +
  coord_cartesian(clip = "off") +
  theme(plot.margin = margin(1, 1, 1, 1, "cm"))



```


#  Product Buy Comparison of 2021 to 2022


```{r echo = FALSE}
# Group the data by Item # and Description and sum the quantity sold for 2021-2022
gpca_table <- aggregate(cbind(`Qty Sold 01/01/22 to 12/31/22`, `Qty Sold 01/01/21 to 12/31/21`) ~ `Item #` + `Description`, data = df, sum)

# Create a line plot of quantity sold
ggplot(gpca_table, aes(x = `Item #`, group = 1)) +
  geom_line(aes(y = `Qty Sold 01/01/22 to 12/31/22`, color = "Qty Sold 2022"), size = 1) +
  geom_point(aes(y = `Qty Sold 01/01/22 to 12/31/22`, color = "Qty Sold 2022"), size = 2) +
  geom_line(aes(y = `Qty Sold 01/01/21 to 12/31/21`, color = "Qty Sold 2021"), size = 1) +
  geom_point(aes(y = `Qty Sold 01/01/21 to 12/31/21`, color = "Qty Sold 2021"), size = 2) +
  geom_line(aes(y = `Qty Sold 01/01/22 to 12/31/22`, linetype = "White Year"), color = "black", size = 1, linetype = "dashed") +
  labs(x = "Item #", y = "Quantity Sold", title = "Quantity Sold Comparison") +
  scale_color_manual(values = c("blue", "red"), labels = c("Qty Sold 2022", "Qty Sold 2021")) +
  scale_shape_manual(values = c(16, 16)) +
  scale_linetype_manual(values = "dashed", labels = "White Year") +
  guides(color = guide_legend(override.aes = list(size = 2))) +
 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))



```

### Product Price Distribution Analysis

#Price Distribution indicates the product price rage we use.


### Price Distribution of 2021

```{r echo = FALSE}

# Create a histogram of the average unit prices
ggplot(df, aes(x = `Average Unit Price 01/01/21 to 12/31/21`)) +
  geom_histogram(fill = "blue", color = "black", bins = 20) +
  labs(x = "Average Unit Price", y = "Frequency", title = "Distribution of Average Unit Prices 2021") +
  theme_minimal()


```

## Price Distribution of 2022

```{r echo = FALSE}
library(ggplot2)



 ggplot(df, aes(x = `Average Unit Price 01/01/22 to 12/31/22`)) +
  geom_histogram(fill = "blue", color = "black", bins = 20) +
  labs(x = "Average Unit Price", y = "Frequency", title = "Distribution of Average Unit Prices (2022)") +
  theme_minimal()


```

# Price Distribution of 2020

```{r echo = FALSE}
library(ggplot2)

df <- read_csv('/Users/nusratprithee/Documents/Rising-Eagle-company-work/Purchase-History-with-Average-Unit-Price-2020-vs.-2021.csv')

df$`Average Unit Price 01/01/20 to 12/31/20` <- as.numeric(gsub("[$,]", "", df$`Average Unit Price 01/01/20 to 12/31/20`))

# Create a histogram of the average unit prices
ggplot(df, aes(x = `Average Unit Price 01/01/20 to 12/31/20`)) +
 geom_histogram(fill = "blue", color = "black", bins = 20) +
  labs(x = "Average Unit Price", y = "Frequency", title = "Distribution of Average Unit Prices (2020)") +
 theme_minimal()

```




